# Извлечение курса RUB/USD с сайта ЦБ РФ

Инструмент командной строки для извлечения данных о курсе обмена RUB/USD за последние 7 дней с сайта Центрального банка России и сохранения их в файл Parquet с метаданными.

## Установка

1. Убедитесь, что установлен Python 3.14+
2. Установите зависимости:

```bash
pip install -r requirements.txt
```

## Использование

Запустите команду :

```bash
python -m src.cli.main
```

Инструмент выполнит следующие действия:

1. Вычислит последние 7 календарных дней: [сегодня, сегодня - 6] (включительно, всего 7 дней)
2. Подключится к API ЦБ РФ и получит данные о курсе обмена
3. Проверит данные
4. Создаст файл Parquet с данными о курсе обмена и метаданными
5. Сохранит файл в текущую рабочую директорию

### Выходные данные

Файл Parquet будет назван по следующему шаблону:

```txt
rub_usd_YYYY-MM-DD_to_YYYY-MM-DD_YYYY-MM-DD_HHMMSS.parquet
```

Например:

```txt
rub_usd_2025-11-25_to_2025-12-01_2025-12-02_143022.parquet
```

### Коды выхода

- `0`: Успех - Данные извлечены и файл создан успешно
- `1`: Ошибка - API ЦБ РФ недоступен или вернул ошибку
- `2`: Ошибка - Таймаут сети или сбой подключения
- `3`: Ошибка - Неверные или некорректные данные от ЦБ РФ
- `4`: Ошибка - Ошибка файловой системы (права доступа, диск заполнен и т.д.)
- `5`: Ошибка - Проверка данных не пройдена

## Разработка

### Структура проекта

```txt
src/
├── models/
│   └── exchange_rate.py      # Модель данных ExchangeRateRecord
├── services/
│   ├── cbr_client.py         # Клиент API ЦБ РФ для извлечения данных
│   └── parquet_writer.py     # Запись файлов Parquet с метаданными
├── cli/
│   └── main.py               # Точка входа CLI и парсинг аргументов
└── utils/
    ├── date_utils.py         # Утилиты для вычисления диапазонов дат
    └── validators.py         # Функции валидации данных

tests/
├── unit/
│   ├── test_cbr_client.py
│   ├── test_parquet_writer.py
│   ├── test_validators.py
│   └── test_date_utils.py
└── integration/
    └── test_end_to_end.py    # Полный поток извлечения и сохранения
```

### Запуск тестов

```bash
pytest
```

## Обработка ошибок

Все ошибки логируются и выводятся в stderr с понятными, удобными для пользователя сообщениями.

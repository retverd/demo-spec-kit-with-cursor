# CLI‑контракт: подкоманда `moex-lqdt`

## Назначение

Запросить дневные свечи LQDT/TQTF за последние 7 календарных дней через ISS‑API и сохранить результат в XLSX‑файл в текущей директории.

## Вызов

```bash
python -m src.cli.main moex-lqdt
```

## Аргументы

- Пользовательских аргументов нет (период фиксирован: последние 7 дней).
- В будущем допускается флаг `--output-dir`, но в MVP не используется.

## Выходной файл

- Формат имени: `lqdt_tqtf_{period_start}_to_{period_end}_{report_date}_{HHMMSS}.xlsx`
- Колонки: `Date, Open, High, Low, Close, Volume`
- Ровно 7 строк по датам периода, пустые ячейки для дней без данных.

## Коды выхода

- `0` — успех
- `1` — ошибка внешнего API Мосбиржи (HTTP 4xx/5xx)
- `2` — сетевой таймаут/ошибка подключения
- `3` — некорректные/повреждённые данные от API
- `4` — ошибка файловой системы при записи XLSX
- `5` — ошибка валидации данных свечей

## Сообщения (stderr, на русском)

- API/сетевые: понятное описание проблемы (недоступен API, таймаут, статус 5xx/4xx)
- Некорректные данные: сообщение о неправильных колонках/формате
- Ошибка ФС: сообщение с причиной (нет прав, диск переполнен и т.д.)
- Валидация: указание, что нарушено (отсутствуют даты, отрицательные значения и т.п.)

## Типовой сценарий

1. Рассчитать период `[today-6 .. today]`.
2. Вызвать `MoexClient.get_daily_candles(start_date, end_date)`.
3. Валидировать `validate_candles(...)`.
4. Сформировать имя файла и записать через `XLSXWriter.write_candles(records, output_dir=".")`.
5. При ошибках вывести сообщение на русском и вернуть соответствующий код.

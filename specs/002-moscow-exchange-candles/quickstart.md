# Quickstart: Получение свечей LQDT/TQTF и сохранение в XLSX

## Предусловия

- Python 3.14
- Установлены зависимости из `requirements.txt`

## Быстрый запуск (по умолчанию создаёт файл в текущей директории)

```bash
python -m src.cli.main moex-lqdt
```

Ожидаемый результат:

- Код выхода `0`
- Создан файл формата `lqdt_tqtf_{period_start}_to_{period_end}_{report_date}_{HHMMSS}.xlsx`
- В файле один лист с колонками: `Date, Open, High, Low, Close, Volume` и 7 строками по датам периода

## Параметры по умолчанию

- Период: последние 7 календарных дней `[today-6, ..., today]`
- Инструмент: `LQDT`
- Доска: `TQTF`
- Формат свечей: дневные (`interval=24` в ISS‑API)

## Типовые сценарии

1. **Успешный запрос**  
   - Команда: `python -m src.cli.main moex-lqdt`  
   - Ожидается: код выхода `0`, лог на русском языке, XLSX с 7 строками.

2. **Недоступен API/сеть**  
   - Сценарий: временно отключён интернет или API возвращает 5xx.  
   - Ожидается: сообщение об ошибке на русском языке в stderr, код выхода `1` (API) или `2` (сеть/таймаут), файл не создаётся.

3. **Нет данных/не найдён инструмент**  
   - Сценарий: ISS‑API не возвращает данных для LQDT/TQTF.  
   - Ожидается: код выхода `3` или `5` в зависимости от причины, сообщение на русском языке, файл не создаётся.

4. **Ошибка записи файла**  
   - Сценарий: нет прав записи или диск переполнен.  
   - Ожидается: код выхода `4`, понятное сообщение на русском языке, отсутствие частично созданного файла.

## Коды выхода

- `0` — успех  
- `1` — ошибка внешнего API (HTTP 4xx/5xx)  
- `2` — сетевой таймаут/ошибка подключения  
- `3` — некорректные данные от API Мосбиржи  
- `4` — ошибка файловой системы при записи XLSX  
- `5` — ошибка валидации данных свечей